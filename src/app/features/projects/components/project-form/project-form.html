<section class="bg-background p-4 sm:p-6 rounded-lg shadow-md shadow-accent border border-primary-300">
  <h2 class="text-xl sm:text-2xl font-bold text-text mb-6">
    {{ isEditMode() ? 'Modifier le projet' : 'Ajouter un nouveau projet' }}
  </h2>

  <form [formGroup]="projectForm" (ngSubmit)="onSubmit()" class="space-y-6">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label for="title" class="block text-sm font-medium text-text/90 mb-2">Titre du projet</label>
        <input id="title" type="text" formControlName="title"
               class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text placeholder-text/50 focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200" />
      </div>

      <div>
        <label for="image" class="block text-sm font-medium text-text/90 mb-2">
          Image du projet {{ !isEditMode() ? '(requis)' : '(optionnel)' }}
        </label>
        <input id="image" type="file" (change)="onFileSelected($event)" accept="image/*"
               class="w-full text-sm text-text file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:font-semibold file:bg-accent file:text-white hover:file:bg-accent/90" />
        <div class="flex space-x-4 mt-4">
          @if (currentImageUrl()) {
            <div>
              <span class="block text-sm font-medium text-text/70 mb-2">Image actuelle :</span>
              <img [ngSrc]="currentImageUrl()!" alt="Image actuelle" width="128" height="128" class="rounded-lg h-32 w-32 object-cover shadow-md"/>
            </div>
          }
          @if (imagePreview()) {
            <div>
              <span class="block text-sm font-medium text-text/70 mb-2">Nouvel aperçu :</span>
              <img [ngSrc]="imagePreview()!" alt="Aperçu de l'image" width="128" height="128" class="rounded-lg h-32 w-32 object-cover shadow-md"/>
            </div>
          }
        </div>
      </div>
    </div>

    <div>
      <label for="description" class="block text-sm font-medium text-text/90 mb-2">Description</label>
      <textarea id="description" formControlName="description" rows="4"
                class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text placeholder-text/50 focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200"></textarea>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-start">
      <div class="md:col-span-1">
        <label for="technologies" class="block text-sm font-medium text-text/90 mb-2">Technologies</label>
        <app-custom-multi-select formControlName="technologies" [options]="technologies"></app-custom-multi-select>
      </div>
      <div class="md:col-span-1">
        <label for="category" class="block text-sm font-medium text-text/90 mb-2">Catégorie</label>
        <select id="category" formControlName="category"
                class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200">
          <option value="frontend">Frontend</option>
          <option value="backend">Backend</option>
          <option value="fullstack">Fullstack</option>
          <option value="script">Script</option>
        </select>
      </div>
      <div class="md:col-span-1">
        <label for="priority" class="block text-sm font-medium text-text/90 mb-2">Priorité sur la page d'accueil</label>
        <select id="priority" formControlName="priority"
                class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200">
          <option [ngValue]="null">Pas mis en avant</option>
          <option [ngValue]="1">Priorité 1 (Haut)</option>
          <option [ngValue]="2">Priorité 2 (Milieu)</option>
          <option [ngValue]="3">Priorité 3 (Bas)</option>
        </select>
        <div class="flex items-center mt-2">
          <input type="checkbox" formControlName="featured" class="toggle toggle-accent toggle-sm" />
          <span class="ml-3 text-xs text-text/70">Compatibilité (ancien featured)</span>
        </div>
      </div>
    </div>

    <div class="space-y-4 p-4 border border-primary-300/50 rounded-lg" formGroupName="github_urls">
      <h3 class="text-lg font-medium text-text">Liens GitHub</h3>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div>
          <label for="frontend" class="block text-sm font-medium text-text/90 mb-2">Frontend</label>
          <input id="frontend" type="text" formControlName="frontend"
                 class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text placeholder-text/50 focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200" />
        </div>
        <div>
          <label for="backend" class="block text-sm font-medium text-text/90 mb-2">Backend</label>
          <input id="backend" type="text" formControlName="backend"
                 class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text placeholder-text/50 focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200" />
        </div>
        <div>
          <label for="fullstack" class="block text-sm font-medium text-text/90 mb-2">Fullstack</label>
          <input id="fullstack" type="text" formControlName="fullstack"
                 class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text placeholder-text/50 focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200" />
        </div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <label for="demo_url" class="block text-sm font-medium text-text/90 mb-2">URL de la démo</label>
        <input id="demo_url" type="text" formControlName="demo_url"
               class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text placeholder-text/50 focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200" />
      </div>
      <div>
        <label for="date" class="block text-sm font-medium text-text/90 mb-2">Date de réalisation</label>
        <input id="date" type="date" formControlName="date"
               class="w-full px-4 py-2 bg-background-200 border border-primary-300 rounded-lg text-text focus:ring-2 focus:ring-accent focus:border-accent outline-none transition-all duration-200" />
      </div>
    </div>


    <div class="mt-8 flex justify-end">
      <app-button
        type="submit"
        color="accent"
        [isLoading]="isLoading()"
[disabled]="!projectForm.valid || (!isEditMode() && !selectedFile)"
        customClass="px-8 py-3 hover:bg-primary/80"
      >
        Enregistrer le projet
      </app-button>
    </div>
  </form>
</section>
